import{_ as o,r as a,o as c,c as p,b as n,d as s,e,w as u,a as t}from"./app-304f5532.js";const r={},d=t(`<h1 id="基础配置" tabindex="-1"><a class="header-anchor" href="#基础配置" aria-hidden="true">#</a> 基础配置</h1><div class="custom-container warning"><p class="custom-container-title">注意</p><p>配置文件为yaml格式，需要严格按照yaml格式书写，否则会报错。</p></div><h2 id="_1-rpc服务端配置" tabindex="-1"><a class="header-anchor" href="#_1-rpc服务端配置" aria-hidden="true">#</a> 1.rpc服务端配置</h2><div class="custom-container tip"><p class="custom-container-title">服务发现</p><p>目前只支持etcd、zookeeper、consul。</p></div><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">rpcServer</span><span class="token punctuation">:</span>
  <span class="token key atrule">serverName</span><span class="token punctuation">:</span> <span class="token string">&quot;authorize&quot;</span>
  <span class="token key atrule">registerPlugin</span><span class="token punctuation">:</span> <span class="token string">&quot;etcd&quot;</span>
  <span class="token key atrule">registerServers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;127.0.0.1:2379&quot;</span>
  <span class="token key atrule">basePath</span><span class="token punctuation">:</span> <span class="token string">&quot;go-admin&quot;</span>
  <span class="token key atrule">addr</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">7655</span>
  <span class="token key atrule">pprof</span><span class="token punctuation">:</span> <span class="token number">7654</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>serverName</code>: 服务名称，作服务发现key</li><li><code>registerPlugin</code>: 服务注册类型。目前支持etcd、zookeeper、consul</li><li><code>registerServers</code>: 服务注册地址</li><li><code>basePath</code>: etcd服务发现的根目录（一般为项目名）</li><li><code>addr</code>: rpc服务地址，一般不填。k8s集群部署时，填写service地址</li><li><code>port</code>: rpc服务端口</li><li><code>pprof</code>: rpc服务pprof端口</li></ul><h2 id="_2-rpc客户端配置" tabindex="-1"><a class="header-anchor" href="#_2-rpc客户端配置" aria-hidden="true">#</a> 2.rpc客户端配置</h2><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">rpcClient</span><span class="token punctuation">:</span>
  <span class="token key atrule">clientName</span><span class="token punctuation">:</span> <span class="token string">&quot;internal-gateway&quot;</span>
  <span class="token key atrule">basePath</span><span class="token punctuation">:</span> <span class="token string">&quot;go-admin&quot;</span>
  <span class="token key atrule">registerPlugin</span><span class="token punctuation">:</span> <span class="token string">&quot;etcd&quot;</span>
  <span class="token key atrule">registerServers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;127.0.0.1:2379&quot;</span>
  <span class="token key atrule">failRetryModel</span><span class="token punctuation">:</span> <span class="token number">3</span>
  <span class="token key atrule">balanceModel</span><span class="token punctuation">:</span> <span class="token number">2</span>
  <span class="token key atrule">poolSize</span><span class="token punctuation">:</span> <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>clientName</code>: 客户端名称</li><li><code>registerPlugin</code>: 服务注册类型。目前支持etcd、zookeeper、consul</li><li><code>registerServers</code>: 服务注册地址</li><li><code>basePath</code>: etcd服务发现的根目录（一般为项目名）</li><li><code>failRetryModel</code>: 失败重试模式。</li><li><code>balanceModel</code>: 负载均衡模式。</li><li><code>poolSize</code>: 连接池大小。</li></ul>`,9),k={class:"custom-container tip"},m=n("p",{class:"custom-container-title"},"关于",-1),v=n("p",null,"默认：",-1),b=n("li",null,[n("code",null,"failRetryModel"),s("：选择相同节点并重试，直到达到最大重试次数")],-1),y=n("code",null,"balanceModel",-1),h={href:"https://zh.wikipedia.org/wiki/%E5%BE%AA%E7%92%B0%E5%88%B6",target:"_blank",rel:"noopener noreferrer"},g=t(`<h2 id="_3-http配置" tabindex="-1"><a class="header-anchor" href="#_3-http配置" aria-hidden="true">#</a> 3.http配置</h2><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">httpServer</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
  <span class="token key atrule">pprof</span><span class="token punctuation">:</span> <span class="token number">8088</span>

<span class="token key atrule">rpcServer</span><span class="token punctuation">:</span>
  <span class="token key atrule">model</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">serverName</span><span class="token punctuation">:</span> <span class="token string">&quot;服务名&quot;</span>
  <span class="token key atrule">etcd</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;127.0.0.1:2379&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">basePath</span><span class="token punctuation">:</span> <span class="token string">&quot;go-admin-example&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>port</code>: http服务端口</li><li><code>pprof</code>: http服务pprof端口</li></ul><h2 id="_4-数据库配置" tabindex="-1"><a class="header-anchor" href="#_4-数据库配置" aria-hidden="true">#</a> 4.数据库配置</h2><div class="custom-container tip"><p class="custom-container-title">数据库类型</p><p>目前只支持mysql</p></div><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">db</span><span class="token punctuation">:</span>
  <span class="token key atrule">dbType</span><span class="token punctuation">:</span> <span class="token string">&quot;mysql&quot;</span>
  <span class="token key atrule">maxOpenConn</span><span class="token punctuation">:</span> <span class="token number">20</span>
  <span class="token key atrule">maxIdleConn</span><span class="token punctuation">:</span> <span class="token number">4</span>
  <span class="token key atrule">maxIdleTime</span><span class="token punctuation">:</span> <span class="token number">100</span>
  <span class="token key atrule">maxLifeTime</span><span class="token punctuation">:</span> <span class="token number">3600</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span> <span class="token number">4</span>
  <span class="token key atrule">slowThreshold</span><span class="token punctuation">:</span> <span class="token string">&quot;100ms&quot;</span>
  <span class="token key atrule">master</span><span class="token punctuation">:</span>
    <span class="token key atrule">user</span><span class="token punctuation">:</span> <span class="token string">&quot;root&quot;</span>
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token string">&quot;password&quot;</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> <span class="token string">&quot;127.0.0.1&quot;</span>
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token string">&quot;3306&quot;</span>
    <span class="token key atrule">database</span><span class="token punctuation">:</span> <span class="token string">&quot;database&quot;</span>
  <span class="token key atrule">slave</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">user</span><span class="token punctuation">:</span> <span class="token string">&quot;root&quot;</span>
      <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token string">&quot;password&quot;</span>
      <span class="token key atrule">host</span><span class="token punctuation">:</span> <span class="token string">&quot;127.0.0.1&quot;</span>
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token string">&quot;3306&quot;</span>
      <span class="token key atrule">database</span><span class="token punctuation">:</span> <span class="token string">&quot;database&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>dbType</code>: 数据库类型</li><li><code>maxOpenConn</code>: 最大打开连接数</li><li><code>maxIdleConn</code>: 最大空闲连接数</li><li><code>maxIdleTime</code>: 最大空闲时间</li><li><code>maxLifeTime</code>: 最大生命周期</li><li><code>level</code>: 日志级别</li><li><code>slowThreshold</code>: 慢日志阈值</li><li><code>master</code>: 主库配置</li><li><code>slave</code>: 从库配置</li></ul><h2 id="_5-redis配置" tabindex="-1"><a class="header-anchor" href="#_5-redis配置" aria-hidden="true">#</a> 5.redis配置</h2><div class="custom-container tip"><p class="custom-container-title">redis模式</p><p>目前支持单机（alone）, 哨兵（sentinel）, 集群（cluster）</p></div><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">redis</span><span class="token punctuation">:</span>
  <span class="token key atrule">redisType</span><span class="token punctuation">:</span> <span class="token string">&quot;alone&quot;</span>
  <span class="token key atrule">startAddr</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;127.0.0.1:6379&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">active</span><span class="token punctuation">:</span> <span class="token number">100</span>
  <span class="token key atrule">idle</span><span class="token punctuation">:</span> <span class="token number">100</span>
  <span class="token key atrule">auth</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>
  <span class="token key atrule">connTimeout</span><span class="token punctuation">:</span> <span class="token string">&quot;100ms&quot;</span>
  <span class="token key atrule">readTimeout</span><span class="token punctuation">:</span> <span class="token string">&quot;100ms&quot;</span>
  <span class="token key atrule">writeTimeout</span><span class="token punctuation">:</span> <span class="token string">&quot;100ms&quot;</span>
  <span class="token key atrule">idleTimeout</span><span class="token punctuation">:</span> <span class="token string">&quot;100ms&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>redisType</code>: redis类型</li><li><code>network</code>: 单机地址</li><li><code>startAddr</code>: 哨兵或集群地址</li><li><code>active</code>: 最大活跃连接数</li><li><code>idle</code>: 最大空闲连接数</li><li><code>auth</code>: 密码</li><li><code>connTimeout</code>: 连接超时时间</li><li><code>readTimeout</code>: 读超时时间</li><li><code>writeTimeout</code>: 写超时时间</li><li><code>idleTimeout</code>: 空闲超时时间</li></ul><h2 id="_6-日志配置" tabindex="-1"><a class="header-anchor" href="#_6-日志配置" aria-hidden="true">#</a> 6.日志配置</h2><div class="custom-container tip"><p class="custom-container-title">日志等级</p><p>0紧急的 1警报 2重要的 3错误 4警告 5提示 6信息 7调试</p></div><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">logger</span><span class="token punctuation">:</span>
  <span class="token key atrule">consoleShow</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">consoleLevel</span><span class="token punctuation">:</span>  <span class="token number">7</span>
  <span class="token key atrule">fileWrite</span><span class="token punctuation">:</span>  <span class="token boolean important">false</span>
  <span class="token key atrule">fileLevel</span><span class="token punctuation">:</span>  <span class="token number">7</span>
  <span class="token key atrule">multiFileWrite</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
  <span class="token key atrule">multiFileLevel</span><span class="token punctuation">:</span> <span class="token number">7</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>consoleShow</code>: 是否打印到控制台</li><li><code>consoleLevel</code>: 控制台日志级别</li><li><code>fileWrite</code>: 是否写入文件</li><li><code>fileLevel</code>: 文件日志级别</li><li><code>multiFileWrite</code>: 是否写入多个文件</li><li><code>multiFileLevel</code>: 多文件日志级别</li></ul><h2 id="_7-链路追踪配置" tabindex="-1"><a class="header-anchor" href="#_7-链路追踪配置" aria-hidden="true">#</a> 7.链路追踪配置</h2><div class="custom-container tip"><p class="custom-container-title">注意</p><p>该配置只会影响链路上报，不会影响正常的日志标记</p></div><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">tracer</span><span class="token punctuation">:</span>
  <span class="token key atrule">openTrace</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
  <span class="token key atrule">traceName</span><span class="token punctuation">:</span> <span class="token string">&quot;服务名&quot;</span>
  <span class="token key atrule">host</span><span class="token punctuation">:</span> <span class="token string">&quot;127.0.0.1:6831&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>openTrace</code>: 是否开启链路追踪</li><li><code>traceName</code>: 服务名</li><li><code>host</code>: 链路追踪上报地址</li></ul>`,19);function q(_,f){const l=a("RouterLink"),i=a("ExternalLinkIcon");return c(),p("div",null,[d,n("div",k,[m,n("p",null,[s("支持的负载均衡模式以及失败重试模式可在rpc进阶中了解。"),e(l,{to:"/zh/guide/upgrade/rpc.html"},{default:u(()=>[s("前往")]),_:1})]),v,n("ul",null,[b,n("li",null,[y,s("：使用 "),n("a",h,[s("roundrobin"),e(i)]),s(" 算法选择节点")])])]),g])}const T=o(r,[["render",q],["__file","baseconfig.html.vue"]]);export{T as default};
